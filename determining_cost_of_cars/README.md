# Определение стоимости автомобилей

Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Необходимо построить модель для определения стоимости. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.

## План по выполнению проекта
1. Загрузка данных
2. Предобработка и исследовательский анализ данных
3. Подготовка выборок для обучения
4. Выбор и обучение моделей
5. Анализ моделей. Вывод

## Описание данных

- **/datasets/autos.csv** - ссылка на данные

**Признаки**

- **DateCrawled** — дата скачивания анкеты из базы
- **VehicleType** — тип автомобильного кузова
- **RegistrationYear** — год регистрации автомобиля
- **Gearbox** — тип коробки передач
- **Power** — мощность (л. с.)
- **Model** — модель автомобиля
- **Kilometer** — пробег (км)
- **RegistrationMonth** — месяц регистрации автомобиля
- **FuelType** — тип топлива
- **Brand** — марка автомобиля
- **Repaired** — была машина в ремонте или нет
- **DateCreated** — дата создания анкеты
- **NumberOfPictures** — количество фотографий автомобиля
- **PostalCode** — почтовый индекс владельца анкеты (пользователя)
- **LastSeen** — дата последней активности пользователя

**Целевой признак**

- **Price** — цена (евро)

## Вывод
**Лучшая модель**: LGBMRegressor с гиперпараметрами:
- nestimators=100
- learningrate=0.2
- maxdepth=8
- randomstate=12345

Модель обучалась на выборке с преобразованными признаками типа object с помощью PCA, оставлено 50 компонентов, описывающих почти 90% данных.

Датасет прошел предобработку в 4 этапа:

1. **Общий анализ:**
- Приведение названий признаков к PEP 8
- Изменение типа данных на datetime
- Удаление признака с нулями и дубликатов

2. **Анализ дат:**
- Обработка аномалий в годе регистрации 
- Удаление признаков: 'datecreated', 'lastseen', 'registrationmonth', 'datecrawled'
- Новые автомобили дороже, регистрация чаще в марте, июне и апреле.

3. **Анализ численных признаков:**
- Удаление аномальных значений мощности и цены
- Практически линейная зависимость мощности от цены.

4. **Анализ категориальных признаков:**
- Автомобили: 20.9% с автоматической, 77.9% с механической КПП.
- 8.2% были в ремонте, 80.8% - не были.
- Топ типы: sedan (29.1%), small (22.9%), wagon (20.9%).
- 62.6% на бензине, 32.4% на газе.
- 242 модели и 40 брендов.
- Пропущенные значения заполнены часто встречающимися значениями.
