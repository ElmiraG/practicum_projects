# Метчинг товаров

Дано два множества объектов: множество A и множество B. Каждый объект в каждом множестве описывается определенными признаками. Цель состоит в том, чтобы для каждого объекта из множества A найти один или несколько объектов из множества B, которые схожи с ним по определенной метрике. Важно отметить, что множества A и B могут быть как различными, так и одинаковыми, и в процессе поиска соответствий может возникнуть ситуация, когда ни один объект из B не будет соответствовать объекту из A.

**Задача:**

- разработать алгоритм, который для всех товаров из validation.csv предложит несколько вариантов наиболее похожих товаров из base;

- оценить качество алгоритма по метрике accuracy@5

## План по выполнению проекта
1. Загрузка данных
2. Предобработка и исследовательский анализ данных
3. Подготовка выборок для обучения
4. Разработатка ранжирующих моделей
5. Анализ моделей
6. Отчет по исследованию

## Исходные данные

- **base.csv** - анонимизированный набор товаров. Каждый товар представлен как уникальный id (0-base, 1-base, 2-base) и вектор признаков размерностью 72.


- **train.csv** - обучающий датасет. Каждая строчка - один товар, для которого известен уникальный id (0-query, 1-query, …) , вектор признаков И id товара из base.csv, который максимально похож на него (по мнению экспертов).


- **validation.csv** - датасет с товарами (уникальный id и вектор признаков), для которых надо найти наиболее близкие товары из base.csv


- **validation_answer.csv** - правильные ответы к предыдущему файлу.

## Вывод

Для решения задачи созданы три выборки:

- Первая выборка содержит исходные датасеты без изменений.
- Вторая выборка включает только признаки с нормальным распределением, исключая столбцы: 6, 21, 25, 33, 44, 59, 65, 70.
- Третья выборка содержит признаки из первых двух выборок, преобразованные с использованием метода главных компонент (PCA). Будет рассмотрено различное количество компонентов.
Для каждой выборки был произведен перебор размера кластера и количества ближайших кластеров.

По итогу, лучше всего показали себя модели из второй выборки и модели из той же выборки, но проведенные через PCA() со снижением дисперсии на 20%. Наиболее высокий показатель accuracy = 70.8% с оптимальным количеством времени обучения - достигнут для второй выборки с n_cells = 50 и n_nprobe = 15.

Получается, что лучший результат достигается при изначальной правильной обработке данных. И только потом на время обучения и метрику может повлиять правильный набор гиперпараметров. Использование PCA() для обработки данных может снизить длительность расчета при незначительном снижении метрики - с разницей в десятых долях, - если использовать для анализа несколько моделей с разным количеством параметров.
