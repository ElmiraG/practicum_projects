# Модель предсказания оттока клиентов телекоммуникационной компании
Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого сотрудники компании начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах. Задача заключается в обучении модели на этих данных для прогноза оттока клиентов.

**Описание услуг**

Оператор предоставляет два основных типа услуг:
- Стационарную телефонную связь. Телефон можно подключить к нескольким линиям одновременно.
- Интернет. Подключение бывает двух типов:
  - через телефонную линию DSL (англ. digital subscriber line — «цифровая абонентская линия»)
  - через оптоволоконный кабель (англ. fiber optic).
- Также абонентам доступен ряд услуг:
  - Интернет-безопасность: антивирус (Device Protection) и блокировка опасных сайтов (Online Security);
  - Выделенная линия технической поддержки (Tech Support);
  - Облачное хранилище файлов для резервного копирования данных (Online Backup);
  - Стриминговое телевидение (Streaming TV) и каталог фильмов (Streaming Movies).

За услуги клиенты могут платить ежемесячно или раз в 1–2 года. Доступны различные способы расчёта и возможность получить электронный чек.

**Описание данных**

Данные хранятся в Sqlite  — СУБД, в которой база данных представлена одним файлом. Она состоит из нескольких таблиц:

- **contract** — информация о договорах;
- **personal** — персональные данные клиентов;
- **internet** — информация об интернет-услугах;
- **phone** — информация об услугах телефонии.

**План по выполнению проекта**
1. Загрузка данных
2. Исследовательский и предобработка данных
4. Обучение моделей
5. Тестирование модели
6. Общий вывод

Информация о договорах актуальна на 1 февраля 2020.

# Общий вывод

1. **Исследование данных**

Тип и метод оплаты, а также наличие дополнительных услуг и семейное положение клиентов влияют на уровень расторжений договоров. Клиенты, платящие ежемесячно, имеют меньший процент расторжений (11%) по сравнению с теми, кто оплачивает раз в год (21%) или раз в два года (22%). Предпочтительный метод оплаты – электронный чек. Высокий процент расторжений наблюдается у клиентов с ежемесячными расходами более 90 долларов и у состоящих в браке. Наличие дополнительных услуг также связано с повышением отказов.

2. **Подготовка данных**

Решено исключить признаки: internet_service, online_security, tech_support из-за их низкой корреляции с целевым признаком.

3. **Обучение модели**

Созданы четыре модели: RandomForestClassifier, CatBoostClassifier, LGBMClassifier и нейронная модель на PyTorch.

Расчет моделей  RandomForestClassifier, CatBoostClassifier и LGBMClassifier происходит с балансировкой классов с помощью гиперпараметров.

В качестве метрики применяется roc_auc.

4. **Лучшая модель**

**Лучашя модель CatBoostClassifier с параметрами:**
- random_state=16924,
- verbose=0,
- depth = 5,
- iterations = 550,
- learning_rate = 0.1,
- scale_pos_weight = 1

5. Анализ результатов тестирования модели

На матрице ошибок мы видим, что модель демонстрирует высокую точность в классификации истинно отрицательных ответов (0.83), однако имеет низкую точность в классификации истинно положительных ответов (0.094). Ложноположительные предсказания (0.014) меньше, чем ложноотрицательные (0.062), что указывает на то, что модель чаще ошибается, пропуская истинные положительные случаи.

- Кривая ROC расположена выше кривой случайных ответов. Значение AUC = 0.93.

- Точность и полнота:

Точность составляет 0.87, что означает, что когда модель предсказывает положительный класс, она правильно делает это примерно в 87% случаев. Полнота равна 0.60, что указывает на то, что модель успешно идентифицирует примерно 60% всех реальных положительных случаев в данных. Accuracy: 0.92.
  
**6.Анализ важности признаков**

Модель посчитала важными такие признаки как:
- продолжительность договора
- ежемесячная оплата
- тип оплаты: раз в два года
- наличие у клиента супруг(а)
- тип оплаты: раз в год
