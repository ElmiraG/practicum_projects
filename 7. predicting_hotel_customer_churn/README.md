# Прогнозирование оттока клиентов в сети отелей «Как в гостях»
## Описание проекта

Строится модель прогнозирования отказа от брони клиента. В качестве метрики предлагается использовать величину выручки которая получится после внедрения модели машинного обучения.

## План по выполнению проекта
1. Загрузка данных. 
2. Предобработка и исследовательский анализ данных.
3. Вычислите бизнес-метрику. Оцените прибыль отеля без внедрения депозитов.
4. Разработка модели ML.
   - Обучить разные модели и оцените их качество кросс-валидацией. Выбрать лучшую модель и проверить её на тестовой выборке. 
   - Выберать метрику для обучения.
   - Оценить прибыль, которую принесёт выбранная модель за год.
5. Выявить признаки «ненадёжного» клиента.
   - На основе исследовательского анализа данных описать клиента, склонного к отказу от брони.
6. Написать общий вывод.

## Описание данных
**Пути к файлам:**
- /datasets/hotel_train.csv — данные для обучения модели.
- /datasets/hotel_test.csv — данные для тестирования модели.

**Описание данных:**

В таблицах hotel_train и hotel_test содержатся одинаковые столбцы:
- **id** — номер записи;
- **adults** — количество взрослых постояльцев; 
- **arrival_date_year** — год заезда;
- **arrival_date_month** — месяц заезда;
- **arrival_date_week_number** — неделя заезда;
- **arrival_date_day_of_month** — день заезда;
- **babies** — количество младенцев;
- **booking_changes** — количество изменений параметров заказа;
- **children** — количество детей от 3 до 14 лет;
- **country** — гражданство постояльца;
- **customer_type** — тип заказчика:
  - **Contract** — договор с юридическим лицом;
  - **Group** — групповой заезд;
  - **Transient** — не связано с договором или групповым заездом;
  - **Transient-party** — не связано с договором или групповым заездом, но связано с бронированием типа Transient.
- **days_in_waiting_list** — сколько дней заказ ожидал подтверждения;
- **distribution_channel** — канал дистрибуции заказа;
- **is_canceled** — отмена заказа;
- **is_repeated_guest** — признак того, что гость бронирует номер второй раз;
- **lead_time** — количество дней между датой бронирования и датой прибытия;
- **meal** — опции заказа:
  - **SC** — нет дополнительных опций;
  - **BB** — включён завтрак;
  - **FB** — включён завтрак, обед и ужин.
  - **HB** — включён завтрак и обед;
- **previous_bookings_not_canceled** — количество подтверждённых заказов у клиента;
- **previous_cancellations** — количество отменённых заказов у клиента;
- **required_car_parking_spaces** — необходимость места для автомобиля;
- **reserved_room_type** — тип забронированной комнаты;
- **stays_in_weekend_nights** — количество ночей в выходные дни;
- **stays_in_week_nights** — количество ночей в будние дни;
- **total_nights** — общее количество ночей;
- **total_of_special_requests** — количество специальных отметок.

## Выводы

**Лучшая модель - RandomForestClassifier с гиперпараметрами:**
- random_state=12345,
- n_estimators=251,
- max_depth=20,
- class_weight='balanced_subsample'.

**Результаты:**
- TN = 0.56, TP = 0.17,
- Ложно отрицательные: 0.15, ложно положительные: 0.12.
- AUC = 0.78, f1 = 0.56, accuracy = 0.73, precision = 0.59, recall = 0.53.

Прибыль после обучения составила 36.77 млн руб, увеличение на 4.47 млн руб за 8 месяцев.

**Ненадежный клиент:**
- Бронирует заранее
- Не оставляет отметок
- Не резервирует парковку
- Длительное пребывание увеличивает вероятность отказа.
