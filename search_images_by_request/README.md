# Поиск изображений по запросу

Поручено разработать демонстрационную версию поиска изображений по запросу.

Для демонстрационной версии нужно обучить модель, которая получит векторное представление изображения, векторное представление текста, а на выходе будет выдавать число от 0 до 1 — показывает, насколько текст и картинка подходят друг другу.

# План по выполнению проекта
1. Загрузка данных
2. Исследовательский анализ данных
3. Создание обобщенной оценки связки изображения-текста
4. Проверка даных
5. Векторизация изображений
6. Векторизция текстов
7. Объединение векторов
8. Обучение модели
9. Тестирование модели
10. Выводы

# Описание данных

- файл `train_dataset.csv` - необходимая для обучения информация: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

- папка `train_images`- изображения для тренировки модели.

- файл `CrowdAnnotations.tsv` — данные по соответствию изображения и описания, полученные с помощью краудсорсинга.

- файл `ExpertAnnotations.tsv` - данные по соответствию изображения и описания, полученные в результате опроса экспертов.

- файл `test_queries.csv` - информация, необходимая для тестирования: идентификатор запроса, текст запроса и релевантное изображение. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

- папка `test_images` - изображения для тестирования модели.

# Выводы

1. В данном проекте был проведен исследовательский анализ данных. В процессе работы с изображениями для обучения было выявлено, что большинство из них имеют недостоверные описания, что создает определенные сложности для дальнейшего анализа. Однако в тестовой выборке изображения лучше соответствуют своим описаниям.
2. Анализ показал, что оценки экспертов распределены более равномерно по сравнению с оценками рекрутеров. Это указывает на более высокую надежность экспертных данных для создания модели.

Не смотря на то, что количество данных, обладающих экспертной оценкой, значительно меньше (примерно в 8 раз) по сравнению с данными, размеченными на краудсорсинговых платформах, я приняла решение использовать данные с эспертной оценкой, так как качество разметки играет ключевую роль в обучении модели

Была разработана обобщенная оценка соответствия изображений и текстов, которая основывалась на принципе голосования среди экспертов. Результаты сохранены в столбце "score".
.3.

Фильтрация обучающей выборки по критериям защиты данных позволила исключить изображения, нарушающие законодательство, тем самым минимизировав риски при использовании данных в машинном обучении и обеспечив соответствие международным стандарта.

Векторизация как изображений, так и текстов была выполнена с использовенных методов, таких как ResNet-18 для изображений и BERT для текста. Для обучения модели предсказания соответствия изображений и текстов был использован метод GroupShuf дляозволилнияизбежать перекрытия данных между тренировочной и тестовой вы Разделение датасета на тренировочную и валидационную выборку происходит в пропорции 7:3.
Для обучения выбраны модели Ridge и нейронная сеть, реализованная с использованием библиотеки PyTorch.

3. Тестирование модели показало, что изображения выводятся схожие для большинства запросов. Это может быть связано с несколькими факторами. Во-первых, возможно, данные не содержат достаточного количества информации для точного предсказания, что может указывать на необходимость дополнительных этапов предобработки или расширения датасета. Во-вторых, может возникнуть проблема с переобучением, если модель чрезмерно настроена на тренировочные данные, что снижает ее обобщающую способность текстов.
